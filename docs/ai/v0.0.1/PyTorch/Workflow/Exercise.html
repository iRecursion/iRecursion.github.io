<!DOCTYPE html>
<html lang="en">
  	<head>
		    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> :: AsciiDoc</title>
    <meta name="generator" content="Antora 3.1.7">

<link rel="stylesheet" href="../../../../_/css/site.css">

<link rel="stylesheet" href="../../../../_/css/vendor/asciidoc.css">

<link rel="stylesheet" href="../../../../_/css/vendor/extra.css">

<link rel="stylesheet" href="../../../../_/css/vendor/vs.css">

<link rel="stylesheet" href="../../../../_/css/vendor/prism-1.29.0-coy.css">


    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  	</head>
  	
  	<body class="article">
		<header class="header">
	<nav class="navbar">
    	<div class="navbar-brand">
  			
  			<a class="navbar-item logo" target="_blank" href="">
				<img src="../../../../_/img/yin-yang-symbol.svg" width="100%" height="50">
			</a>
  			
	            <div id="main" style="place-content: center;">
	                    <input id="search-input" type="text" placeholder="Type for Retrieving...">
		            </div>
		        </section>
    	</div>
    	
    	<div id="topbar-nav" class="navbar-menu">
      		<div class="navbar-end">
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Culture</div>
          			<div class="navbar-dropdown is-right">
            			
			            <div class="navbar-item">Traditional Culture</div>
			            
			            <a class="navbar-item" target="_blank" href="../../../../culture/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Culture <small>传统文化</small></span>
			            </a>
        			</div>
    			</div>
    			
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Eco</div>
          			
          			<div class="navbar-dropdown is-right">
			            <a class="navbar-item" target="_blank" href="../../../../multifariousness/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Multifariousness <small>五花八门</small></span>
			            </a>

			            <hr class="navbar-divider">
			            <a class="navbar-item" target="_blank" href="../../../../ai/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Artificial Intelligence<small>人工智能</small></span>
			            </a>
			            
			            <hr class="navbar-divider">
			            <a class="navbar-item" target="_blank" href="../../../../msg/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Messaging - Kafka <small>Kafka</small></span>
			            </a>
        			</div>
    			</div>
    			
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Experiment</div>
          			
          			<div class="navbar-dropdown is-right">
			            <div class="navbar-item">Quantum Computing</div>
			            
			            <a class="navbar-item" href="#">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>QC <small>量子计算...</small></span>
			            </a>
			            
			            <hr class="navbar-divider">
			            <div class="navbar-item">Harmony</div>
			            
			            <a class="navbar-item" href="#">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>CangJie <small>预览版内测...</small></span>
			            </a>
        			</div>
    			</div>
      		</div>
    	</div>
	</nav>
</header>
		<div class="body">
	<div class="nav-container" data-component="ai" data-version="v0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../index.html">AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Fundamental</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/PytorchInstallation.html">Pytorch Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorIntro.html">Tensor Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/InfoRetrieving.html">Info Retrieving</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Manipulating.html">Manipulating</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/ShapeError.html">Shape Error</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Indexing.html">Indexing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorNumPy.html">Tensor NumPy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Reproducibility.html">Reproducibility</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorOnGpu.html">Tensor On Gpu</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Workflow</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="WorkflowIntro.html">Workflow Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="DataPreparingLoading.html">Data Preparing Loading</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="BuildModel.html">Build Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="TrainModel.html">Train Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="PredictionInference.html">Prediction Inference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="SavingLoadingModel.html">Saving Loading Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="PuttingTogether.html">Putting Together</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">NN Classification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/NNClassificationIntro.html">NNC Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/GettingDataReady.html">Getting Data Ready</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/BuildingModel.html">Building Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/TrainModel.html">Train Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/PredictionEvaluating.html">Prediction Evaluating</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/ImprovingModel.html">Improving Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/NonLinearity.html">Non Linearity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/ReplicatingNonLinearityAF.html">Replicating Non Linearity AF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/PuttingTogetherMultiClass.html">Putting Together MultiClass</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/EvaluationMetric.html">Evaluation Metric</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/Exercise.html">Exercise</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Computer Vision</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ComputerVisionIntro.html">ComputerVisionIntro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/GettingDataset.html">Getting Dataset</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/PrepareDataLoader.html">Prepare DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildBaselineModel.html">Build Baseline Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/PredictionWithResult.html">Prediction With Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/SetupDeviceAgnosticCode.html">Setup Device Agnostic Code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildingNonLinearityModel.html">Building Non Linearity Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildCnn.html">Build Cnn</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/CompareResultTrainingTime.html">Result and Training Time</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/EvaluateRandomPrediction.html">Evaluate Random Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ConfusionMatrix.html">Confusion Matrix</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/SaveAndLoad.html">Save And Load</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Custom Dataset</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/CustomDatasetIntro.html">Custom Dataset Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/DataPreparation.html">Data Preparation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/TransformingData.html">Transforming Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/OptionALoadingImgDataViaImageFolder.html">Loading ImageFolder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/OptionBLoadingImgDataWithCustomDataset.html">Loading Custom Dataset</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/TransformFormDataAugmentation.html">Data Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ModelATinyVGGWithoutDataAugmentation.html">Without Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/LossCurve.html">Loss Curve</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ModelBTinyVGGWithDataAugmentation.html">With Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/CompareModelResult.html">Compare Model Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/PredictionOnCustomImg.html">Prediction On Custom Img</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Modular</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/ModularIntro.html">Modular Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/CellVSScript.html">Cell VS Script</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/MakingModel.html">Making Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/CombiningTrainTest.html">Combining Train Test</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/SavingModel.html">Saving Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/TrainingEvaluatingSaving.html">Training Evaluating Saving</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transfer Learning</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TransferLearningIntro.html">Transfer Learning Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/FindPretrainedModel.html">FindPretrainedModel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TransferLearningCover.html">Transfer Learning Cover</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/SettingUp.html">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/GettingPretrainedModel.html">Getting Pretrained Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TrainingModel.html">Training Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/EvaluatingModel.html">Evaluating Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/MakingPrediction.html">Making Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Experiment Tracking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/TrackExperimentIntro.html">Track Experiment Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/TrainModelTrackResult.html">Train Model Track Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/ViewModelResult.html">View Model Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/HelperFunction.html">Helper Function</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/SetupModellingExperiment.html">Setup Modelling Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/ViewExperiment.html">View Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/LoadModelPrediction.html">Load Model Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/Exercise.html">Exercise</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Paper Replicating</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/PaperReplicatingIntro.html">Paper Replicating Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/ReplicatingViTPaper.html">Replicating ViT Paper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationAScpp.html">Equation A Scpp</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationBMsa.html">Equation B MSA</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationCMlp.html">Equation C MLP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/CreateTransformerEncoder.html">Create Transformer Encoder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/PuttingViTTogether.html">Putting ViT Together</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/SettingViTModel.html">Setting ViT Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/UsingPretrainedViT.html">Using Pretrained ViT</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/MakePrediction.html">Make Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Model Deployment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ModelDeploymentIntro.html">Model Deployment Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/DeploymentExperimentOutline.html">Deployment Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/EffNetB2FeatureExtractor.html">EffNetB2 Feature Extractor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ViTFeatureExtractor.html">ViT Feature Extractor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/MakingPrediction.html">Making Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ComparingResultTimeSize.html">Comparing Result Time Size</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/CreatingGradio.html">Creating Gradio</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/TurningDemoDeployable.html">Turning Demo Deployable</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/DeployingHuggingFace.html">Deploying HuggingFace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/CreatingFoodVision.html">Creating Food Vision</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/TurningModelDeployable.html">Turning Model Deployable</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Version 2X</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/Version2XIntro.html">Version 2X Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/GettingGPUInfo.html">Getting GPU Info</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/SetupExperiment.html">Setup Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/TimeModelSingleRun.html">Time Model Single Run</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/TimeModelMultipleRun.html">Time Model Multiple Run</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/PossibleImprovementExtension.html">Improvement Extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/Resource.html">Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Solitary</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchExtraResource.html">PyTorch Extra Resource</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchCheatSheet.html">PyTorch Cheat Sheet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchCommonError.html">PyTorch Common Error</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spring AI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Intro</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIConcept.html">Spring AI Concept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIDependency.html">Spring AI Dependency</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIObservability.html">Spring AI Observability</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/DockerCompose.html">Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/Testcontainer.html">Testcontainer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/CloudBinding.html">Cloud Binding</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Api Solitary</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/ApiIntro.html">Api Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/GenericModel.html">GenericModel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/ChatClient.html">Chat Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/FunctionCalling.html">Function Calling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/Multimodality.html">Multimodality</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/Prompt.html">Prompt</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/StructureOutput.html">Structure Output</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/EtlPipeline.html">ETL Pipeline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/EvaluationTesting.html">Evaluation Testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Chat Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/ChatModelIntro.html">Chat Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/HuggingFace.html">Hugging Face</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/MiniMaxChat.html">MiniMax Chat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/MiniMaxFunctionCalling.html">MiniMax Function Calling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/Moonshot.html">Moonshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/Nvidia.html">Nvidia</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/OllamaChat.html">OllamaChat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/QianFanChat.html">QianFan Chat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/ZhiPuChat.html">ZhiPuChat</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Embedding Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingModelIntro.html">Embedding Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/MiniMax.html">MiniMax</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/OllamaEmbedding.html">Ollama Embedding</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/OnnxTransformer.html">Onnx Transformer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/Pgml.html">Postgre ML</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingQianFan.html">QianFan</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingZhiPu.html">ZhiPu</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Image Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/ImageModelIntro.html">Image Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/EmbeddingZhiPu.html">ZhiPu</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/EmbeddingQianFan.html">QianFan</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Audio Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Audio/Transcription.html">Transcription</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Audio/Tts.html">Text To Speech</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Moderation Model</span>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vector Store</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/VectorStoreIntro.html">Vector Store Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Chroma.html">Chroma</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Elastic.html">Elastic Vector</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Milvus.html">Milvus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Neo4j.html">Neo4j</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/OpenSearch.html">Open Search</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/OracleStore.html">Oracle Store</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/PostgreVector.html">Postgre Vector</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Qdrant.html">Qdrant</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Redis.html">Redis</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Typesense.html">Typesense</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Weaviate.html">Weaviate</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AI</span>
    <span class="version">v0.0.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../index.html">AI</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../culture/v0.0.1/index.html">Culture</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../culture/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../msg/v0.0.1/index.html">Message</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../msg/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../multifariousness/v0.0.1/index.html">Multifariousness</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../multifariousness/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
	<main class="article">
	<div class="toolbar" role="navigation">
	<button class="nav-toggle"></button>
	
		<a href="../../../../multifariousness/v0.0.1/index.html" 
			class="home-link">
		</a>

	<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">AI</a></li>
    <li>PyTorch</li>
    <li>PyTorch Workflow</li>
    <li><a href="Exercise.html">Exercise</a></li>
  </ul>
</nav>
		</div>
	
	<div class="content">
			<aside class="toc sidebar" 
	data-title="Contents" 
	data-levels="2">
  <div class="toc-menu"></div>
</aside>
			<article class="doc">
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_intro">1. Intro</a></li>
<li><a href="#_create_dataset">2. Create Dataset</a></li>
<li><a href="#_build_model">3. Build Model</a></li>
<li><a href="#_loss_function_optimizer">4. Loss Function Optimizer</a></li>
<li><a href="#_make_prediction">5. Make Prediction</a></li>
<li><a href="#_save_model">6. Save Model</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_intro"><a class="anchor" href="#_intro"></a>1. Intro</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>注：代码应与设备无关(device agnostic)，即可在CPU或GPU上运行；</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import datetime
print(f"Last Update: {datetime.datetime.now()}")

import torch
import matplotlib.pyplot as plt
from torch import nn

device = "cuda" if torch.cuda.is_available() else "cpu"
device
print(f"Device:: {device}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_dataset"><a class="anchor" href="#_create_dataset"></a>2. Create Dataset</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>使用线性回归公式(权重 * X + 偏差)创建直线数据集；<br>
create straight line dataset via<br>
linear regression formula：<mark>weight * X + bias</mark></p>
</li>
<li>
<p>设置权重 = 0.3 和偏差 = 0.9，总共应至少有 100 个数据点，<br>
set weight=0.3 and bias=0.9，at least 100 datapoint total；</p>
</li>
<li>
<p>将数据分为 80% 训练和 20% 测试，<br>
split data into 80% training and 20% testing；</p>
</li>
<li>
<p>绘制训练和测试数据，使其变得直观，<br>
plot training and testing data and become visual；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># A：create dataset

# create data parameter
weight = 0.3
bias = 0.9

# make X and y using linear regression feature
X = torch.arange(0,1,0.01).unsqueeze(dim = 1)
y = weight * X + bias
print(f"Number of X Sample: {len(X)}")
print(f"Number of y Sample: {len(y)}")
print(f"First 10 X &amp; y Sample:\nX: {X[:10]}\ny: {y[:10]}")

# split data into training and testing
train_split = int(len(X) * 0.8)
X_train = X[:train_split]
y_train = y[:train_split]
X_test = X[train_split:]
y_test = y[train_split:]
len(X_train),len(y_train),len(X_test),len(y_test)

# plot training and testing data
def plot_prediction(train_data = X_train,
                 train_labels = y_train,
                 test_data = X_test,
                 test_labels = y_test,
                 prediction = None):
  plt.figure(figsize = (10,7))
  plt.scatter(train_data,train_labels,c = 'b',s = 4,label = "Training Data")
  plt.scatter(test_data,test_labels,c = 'g',s = 4,label = "Testing Data")

  if prediction is not None:
    plt.scatter(test_data,prediction,c = 'r',s = 4,label = "Prediction")
  plt.legend(prop = {"size" : 14})
plot_prediction()

plt.savefig("VisualizeDataSplittingExercise.svg")</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/VisualizeDataSplittingExercise.svg" alt="VisualizeDataSplittingExercise">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_model"><a class="anchor" href="#_build_model"></a>3. Build Model</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>build pytorch model by subclassing nn.Module；</p>
</li>
<li>
<p>里面应是随机初始化的参数，其中require_grad=True，一个用于权重，一个用于偏差；</p>
</li>
<li>
<p>randomly initialize nn.Parameter() with requires_grad=True，<br>
one for weight and one for bias；</p>
</li>
<li>
<p>实现forward()来计算在 <mark>创建数据集章节</mark> 中创建数据集时使用的线性回归函数；</p>
</li>
<li>
<p>implment forward() to compute linear regression<br>
function used to <mark>Chapter Create Dataset</mark></p>
</li>
<li>
<p>构建construct模型后，创建它的一个实例并检查其state_dict()，<br>
make instance of it and check its state_dict()；</p>
</li>
<li>
<p>注：可使用nn.Linear()替代nn.Parameter()；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># B：build model
# create PyTorch linear regression model by subclassing nn.Module
## Option 1
class LinearRegressionModel(nn.Module):
  def __init__(self):
    super().__init__()
    self.weight = nn.Parameter(data=torch.randn(1,requires_grad=True,dtype=torch.float))
    self.bias = nn.Parameter(data=torch.randn(1,requires_grad=True,dtype=torch.float))
  def forward(self, x):
    return self.weight * x + self.bias

# ## Option 2
# class LinearRegressionModel(nn.Module):
#   def __init__(self):
#     super().__init__()
#     self.linear_layer = nn.Linear(in_features = 1,out_features = 1)
#   def forward(self,x : torch.Tensor) -&gt; torch.Tensor:
#     return self.linear_layer(x)

torch.manual_seed(42)
model_1 = LinearRegressionModel()
model_1,model_1.state_dict()

next(model_1.parameters()).device

# instantiate model and put it to target device
model_1.to(device)
list(model_1.parameters())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_loss_function_optimizer"><a class="anchor" href="#_loss_function_optimizer"></a>4. Loss Function Optimizer</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>用nn.L1Loss()创建损失函数，用torch.optim.SGD(param,lr)创建优化器；</p>
</li>
<li>
<p>create loss function and optimizer via nn.L1Loss()<br>
and torch.optim.SGD(param,lr) respectively；</p>
</li>
<li>
<p>将优化器的学习率设置为0.01，且要优化的参数应该是我们在<br>
<mark>构建模型章节</mark> 中创建的模型中的模型参数；</p>
</li>
<li>
<p>set optimizer learning rate to 0.01 and parameter to optimize；</p>
</li>
<li>
<p>编写训练循环，以执行300个epoch的适当训练步骤，write training loop<br>
to perform appropriate training step for 300 epoch；</p>
</li>
<li>
<p>训练循环应该每20个epoch在测试数据集上测试模型，<br>
training loop should test model on test dataset every 20 epoch；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># C：loss function and optimizer
# create loss function and optimizer
loss_fn = nn.L1Loss()
optimizer = torch.optim.SGD(params = model_1.parameters(),lr = 0.01)

# Training loop
# Train model for 300 epoch
torch.manual_seed(42)

epoch = 300

# send data to target device
X_train = X_train.to(device)
X_test = X_test.to(device)
y_train = y_train.to(device)
y_test = y_test.to(device)

for e in range(epoch):
  ### Training

  # Put model in train mode
  model_1.train()

  # 1. Forward pass
  y_pred = model_1(X_train)

  # 2. Calculate loss
  loss = loss_fn(y_pred,y_train)

  # 3. Zero gradients
  optimizer.zero_grad()

  # 4. Backpropagation
  loss.backward()

  # 5. Step the optimizer
  optimizer.step()

  ### Perform testing every 20 epochs
  if epoch % 20 == 0:
    # Put model in evaluation mode and setup inference context
    model_1.eval()
    with torch.inference_mode():
      # 1. Forward pass
      y_preds = model_1(X_test)
      # 2. Calculate test loss
      test_loss = loss_fn(y_preds,y_test)
      # Print out what's happening
      print(f"Epoch: {e} | Train loss: {loss:.3f} | Test loss: {test_loss:.3f}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_make_prediction"><a class="anchor" href="#_make_prediction"></a>5. Make Prediction</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>使用经过训练的模型对测试数据进行预测，<br>
make prediction with trained model on test data；</p>
</li>
<li>
<p>将这些预测与原始训练和测试数据进行可视化，visualize<br>
prediction against original training and testing data；</p>
</li>
<li>
<p><mark>注：若想用未启用CUDA的库，如matplotlib绘图，则可能需确保预测不在GPU上</mark>；</p>
</li>
<li>
<p>note：need to make sure prediction are not on GPU if we want to<br>
use non-CUDA-enabled library such as matplotlib to plot；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># D：Make Prediction

# Make predictions with model
model_1.eval()

with torch.inference_mode():
  y_pred = model_1(X_test)
y_pred

# y_preds.cpu()

# ploy prediction (these may need to be on a specific device)
plot_prediction(prediction = y_pred.cpu())

plt.savefig("VisualizeBuildModelPredictionExercise.svg")</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/VisualizeBuildModelPredictionExercise.svg" alt="VisualizeBuildModelPredictionExercise">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_save_model"><a class="anchor" href="#_save_model"></a>6. Save Model</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>将经过训练的模型的state_dict()保存到文件中，<br>
save trained model state_dict() to file；</p>
</li>
<li>
<p>在构建模型章节中创建的模型类创建一个新实例，并加载刚刚保存到其中的state_dict()，<br>
用加载的模型对测试数据预测，并确认它们与预测章节中的原始模型预测相匹配；</p>
</li>
<li>
<p>create model new instance class from <mark>Chapter Build Model</mark><br>
and load in state_dict() we just saved to it；</p>
</li>
<li>
<p>perform prediction on test data with loaded model and confirm<br>
they match original model prediction from <mark>Chapter Make Prediction</mark>；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># E:save model
from pathlib import Path

# 1. Create models directory
MODEL_PATH = Path("model")
MODEL_PATH.mkdir(parents = True,exist_ok = True)
# 2. Create model save path
MODEL_NAME = "01_pytorch_model"
MODEL_SAVE_PATH = MODEL_PATH / MODEL_NAME
# 3. Save the model state dict
print(f"Saving model to {MODEL_SAVE_PATH}")
torch.save(obj = model_1.state_dict(),f = MODEL_SAVE_PATH)

# Create new instance of model and load saved
# state dict (make sure to put it on the target device)
loaded_model = LinearRegressionModel()
loaded_model.load_state_dict(torch.load(f = MODEL_SAVE_PATH))
loaded_model.to(device)

# Make predictions with loaded model and compare them to the previous
y_pred_new = loaded_model(X_test)
print(y_pred == y_pred_new)

print(loaded_model.state_dict())</code></pre>
</div>
</div>
</div>
</div>
</article>
	</div>
</main>
</div>
		<footer class="footer">
	
	
	
	<div class="footer-thanks">
		Authored in AsciiDoc
		<br /><br />
		Produced by Antora and Asciidoctor
  	</div>
  
	<div class="footer-legal" style="text-align:center">
		Gitee：<a href="https://gitee.com/iRecursion" 
			target="_blank">https://gitee.com/iRecursion</a>
		
		<br /><br />
		
		Github：<a href="https://github.com/iRecursion" 
			target="_blank">https://github.com/iRecursion</a>
	</div>
  
	<div class="footer-thanks" style="text-align:left">
		Copyright © 2024 Elf
		<br /><br />
		<address>
			Mailto：<a href="mailto:2032047511@qq.com">2032047511@qq.com</a>
		</address>
	</div>
	
</footer><script id="site-script" src="../../../../_/js/site.js" 
	data-ui-root-path="../../../../_"></script>

<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>



<script async src="../../../../_/js/vendor/prism-1.29.0-coy.js"></script>
  	</body>
</html>
