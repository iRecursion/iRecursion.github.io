<!DOCTYPE html>
<html lang="en">
  	<head>
		    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> :: AsciiDoc</title>
    <meta name="generator" content="Antora 3.1.7">

<link rel="stylesheet" href="../../../../_/css/site.css">

<link rel="stylesheet" href="../../../../_/css/vendor/asciidoc.css">

<link rel="stylesheet" href="../../../../_/css/vendor/extra.css">

<link rel="stylesheet" href="../../../../_/css/vendor/vs.css">

<link rel="stylesheet" href="../../../../_/css/vendor/prism-1.29.0-coy.css">


    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  	</head>
  	
  	<body class="article">
		<header class="header">
	<nav class="navbar">
    	<div class="navbar-brand">
  			
  			<a class="navbar-item logo" target="_blank" href="">
				<img src="../../../../_/img/yin-yang-symbol.svg" width="100%" height="50">
			</a>
  			
	            <div id="main" style="place-content: center;">
	                    <input id="search-input" type="text" placeholder="Type for Retrieving...">
		            </div>
		        </section>
    	</div>
    	
    	<div id="topbar-nav" class="navbar-menu">
      		<div class="navbar-end">
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Culture</div>
          			<div class="navbar-dropdown is-right">
            			
			            <div class="navbar-item">Traditional Culture</div>
			            
			            <a class="navbar-item" target="_blank" href="../../../../culture/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Culture <small>传统文化</small></span>
			            </a>
        			</div>
    			</div>
    			
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Eco</div>
          			
          			<div class="navbar-dropdown is-right">
			            <a class="navbar-item" target="_blank" href="../../../../multifariousness/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Multifariousness <small>五花八门</small></span>
			            </a>

			            <hr class="navbar-divider">
			            <a class="navbar-item" target="_blank" href="../../../../ai/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Artificial Intelligence<small>人工智能</small></span>
			            </a>
			            
			            <hr class="navbar-divider">
			            <a class="navbar-item" target="_blank" href="../../../../msg/v0.0.1/index.html">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>Messaging - Kafka <small>Kafka</small></span>
			            </a>
        			</div>
    			</div>
    			
				<div class="navbar-item has-dropdown is-hoverable">
          			<div class="navbar-link">Experiment</div>
          			
          			<div class="navbar-dropdown is-right">
			            <div class="navbar-item">Quantum Computing</div>
			            
			            <a class="navbar-item" href="#">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>QC <small>量子计算...</small></span>
			            </a>
			            
			            <hr class="navbar-divider">
			            <div class="navbar-item">Harmony</div>
			            
			            <a class="navbar-item" href="#">
			            	<span class="icon"><img src="../../../../_/img/octicons-16.svg"></span>
	              			<span>CangJie <small>预览版内测...</small></span>
			            </a>
        			</div>
    			</div>
      		</div>
    	</div>
	</nav>
</header>
		<div class="body">
	<div class="nav-container" data-component="ai" data-version="v0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../index.html">AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Fundamental</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/PytorchInstallation.html">Pytorch Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorIntro.html">Tensor Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/InfoRetrieving.html">Info Retrieving</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Manipulating.html">Manipulating</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/ShapeError.html">Shape Error</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Indexing.html">Indexing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorNumPy.html">Tensor NumPy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Reproducibility.html">Reproducibility</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/TensorOnGpu.html">Tensor On Gpu</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Fundamental/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Workflow</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="WorkflowIntro.html">Workflow Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="DataPreparingLoading.html">Data Preparing Loading</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="BuildModel.html">Build Model</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="TrainModel.html">Train Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="PredictionInference.html">Prediction Inference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="SavingLoadingModel.html">Saving Loading Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="PuttingTogether.html">Putting Together</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">NN Classification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/NNClassificationIntro.html">NNC Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/GettingDataReady.html">Getting Data Ready</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/BuildingModel.html">Building Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/TrainModel.html">Train Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/PredictionEvaluating.html">Prediction Evaluating</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/ImprovingModel.html">Improving Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/NonLinearity.html">Non Linearity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/ReplicatingNonLinearityAF.html">Replicating Non Linearity AF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/PuttingTogetherMultiClass.html">Putting Together MultiClass</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/EvaluationMetric.html">Evaluation Metric</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Classification/Exercise.html">Exercise</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Computer Vision</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ComputerVisionIntro.html">ComputerVisionIntro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/GettingDataset.html">Getting Dataset</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/PrepareDataLoader.html">Prepare DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildBaselineModel.html">Build Baseline Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/PredictionWithResult.html">Prediction With Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/SetupDeviceAgnosticCode.html">Setup Device Agnostic Code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildingNonLinearityModel.html">Building Non Linearity Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/BuildCnn.html">Build Cnn</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/CompareResultTrainingTime.html">Result and Training Time</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/EvaluateRandomPrediction.html">Evaluate Random Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ConfusionMatrix.html">Confusion Matrix</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/SaveAndLoad.html">Save And Load</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ComputerVision/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Custom Dataset</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/CustomDatasetIntro.html">Custom Dataset Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/DataPreparation.html">Data Preparation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/TransformingData.html">Transforming Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/OptionALoadingImgDataViaImageFolder.html">Loading ImageFolder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/OptionBLoadingImgDataWithCustomDataset.html">Loading Custom Dataset</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/TransformFormDataAugmentation.html">Data Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ModelATinyVGGWithoutDataAugmentation.html">Without Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/LossCurve.html">Loss Curve</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ModelBTinyVGGWithDataAugmentation.html">With Augmentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/CompareModelResult.html">Compare Model Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/PredictionOnCustomImg.html">Prediction On Custom Img</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../CustomDataset/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PyTorch Modular</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/ModularIntro.html">Modular Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/CellVSScript.html">Cell VS Script</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/MakingModel.html">Making Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/CombiningTrainTest.html">Combining Train Test</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/SavingModel.html">Saving Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/TrainingEvaluatingSaving.html">Training Evaluating Saving</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Modular/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transfer Learning</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TransferLearningIntro.html">Transfer Learning Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/FindPretrainedModel.html">FindPretrainedModel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TransferLearningCover.html">Transfer Learning Cover</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/SettingUp.html">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/GettingPretrainedModel.html">Getting Pretrained Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/TrainingModel.html">Training Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/EvaluatingModel.html">Evaluating Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/MakingPrediction.html">Making Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../TransferLearning/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Experiment Tracking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/TrackExperimentIntro.html">Track Experiment Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/TrainModelTrackResult.html">Train Model Track Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/ViewModelResult.html">View Model Result</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/HelperFunction.html">Helper Function</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/SetupModellingExperiment.html">Setup Modelling Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/ViewExperiment.html">View Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/LoadModelPrediction.html">Load Model Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ExperimentTracking/Exercise.html">Exercise</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Paper Replicating</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/PaperReplicatingIntro.html">Paper Replicating Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/CreateDatasetDataLoader.html">Create Dataset DataLoader</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/ReplicatingViTPaper.html">Replicating ViT Paper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationAScpp.html">Equation A Scpp</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationBMsa.html">Equation B MSA</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/EquationCMlp.html">Equation C MLP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/CreateTransformerEncoder.html">Create Transformer Encoder</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/PuttingViTTogether.html">Putting ViT Together</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/SettingViTModel.html">Setting ViT Model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/UsingPretrainedViT.html">Using Pretrained ViT</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/MakePrediction.html">Make Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../PaperReplicating/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Model Deployment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ModelDeploymentIntro.html">Model Deployment Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/GettingData.html">Getting Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/DeploymentExperimentOutline.html">Deployment Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/EffNetB2FeatureExtractor.html">EffNetB2 Feature Extractor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ViTFeatureExtractor.html">ViT Feature Extractor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/MakingPrediction.html">Making Prediction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ComparingResultTimeSize.html">Comparing Result Time Size</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/CreatingGradio.html">Creating Gradio</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/TurningDemoDeployable.html">Turning Demo Deployable</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/DeployingHuggingFace.html">Deploying HuggingFace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/CreatingFoodVision.html">Creating Food Vision</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/TurningModelDeployable.html">Turning Model Deployable</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/Takeaway.html">Takeaway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/Exercise.html">Exercise</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../ModelDeployment/ExtraCurriculum.html">Extra Curriculum</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Version 2X</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/Version2XIntro.html">Version 2X Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/GettingSetup.html">Getting Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/GettingGPUInfo.html">Getting GPU Info</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/SetupExperiment.html">Setup Experiment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/TimeModelSingleRun.html">Time Model Single Run</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/TimeModelMultipleRun.html">Time Model Multiple Run</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/PossibleImprovementExtension.html">Improvement Extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Version2X/Resource.html">Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Solitary</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchExtraResource.html">PyTorch Extra Resource</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchCheatSheet.html">PyTorch Cheat Sheet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solitary/PyTorchCommonError.html">PyTorch Common Error</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spring AI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Intro</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIConcept.html">Spring AI Concept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIDependency.html">Spring AI Dependency</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/SpringAIObservability.html">Spring AI Observability</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/DockerCompose.html">Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/Testcontainer.html">Testcontainer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Intro/CloudBinding.html">Cloud Binding</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Api Solitary</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/ApiIntro.html">Api Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/GenericModel.html">GenericModel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/ChatClient.html">Chat Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/FunctionCalling.html">Function Calling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/Multimodality.html">Multimodality</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/Prompt.html">Prompt</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/StructureOutput.html">Structure Output</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/EtlPipeline.html">ETL Pipeline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Solitary/EvaluationTesting.html">Evaluation Testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Chat Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/ChatModelIntro.html">Chat Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/HuggingFace.html">Hugging Face</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/MiniMaxChat.html">MiniMax Chat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/MiniMaxFunctionCalling.html">MiniMax Function Calling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/Moonshot.html">Moonshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/Nvidia.html">Nvidia</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/OllamaChat.html">OllamaChat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/QianFanChat.html">QianFan Chat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Chat/ZhiPuChat.html">ZhiPuChat</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Embedding Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingModelIntro.html">Embedding Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/MiniMax.html">MiniMax</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/OllamaEmbedding.html">Ollama Embedding</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/OnnxTransformer.html">Onnx Transformer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/Pgml.html">Postgre ML</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingQianFan.html">QianFan</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Embedding/EmbeddingZhiPu.html">ZhiPu</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Image Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/ImageModelIntro.html">Image Model Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/EmbeddingZhiPu.html">ZhiPu</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Image/EmbeddingQianFan.html">QianFan</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Audio Model</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Audio/Transcription.html">Transcription</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Audio/Tts.html">Text To Speech</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Moderation Model</span>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vector Store</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/VectorStoreIntro.html">Vector Store Intro</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Chroma.html">Chroma</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Elastic.html">Elastic Vector</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Milvus.html">Milvus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Neo4j.html">Neo4j</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/OpenSearch.html">Open Search</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/OracleStore.html">Oracle Store</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/PostgreVector.html">Postgre Vector</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Qdrant.html">Qdrant</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Redis.html">Redis</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Typesense.html">Typesense</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../SpringAI/Vector/Weaviate.html">Weaviate</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AI</span>
    <span class="version">v0.0.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../index.html">AI</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../culture/v0.0.1/index.html">Culture</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../culture/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../multifariousness/v0.0.1/index.html">Multifariousness</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../multifariousness/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
	<main class="article">
	<div class="toolbar" role="navigation">
	<button class="nav-toggle"></button>
	
		<a href="../../../../multifariousness/v0.0.1/index.html" 
			class="home-link">
		</a>

	<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">AI</a></li>
    <li>PyTorch</li>
    <li>PyTorch Workflow</li>
    <li><a href="TrainModel.html">Train Model</a></li>
  </ul>
</nav>
		</div>
	
	<div class="content">
			<aside class="toc sidebar" 
	data-title="Contents" 
	data-levels="2">
  <div class="toc-menu"></div>
</aside>
			<article class="doc">
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_train_model">1. Train Model</a>
<ul class="sectlevel2">
<li><a href="#_loss_function_optimizer">1.1. Loss Function Optimizer</a></li>
<li><a href="#_optimization_loop">1.2. Optimization Loop</a></li>
<li><a href="#_training_loop">1.3. Training Loop</a></li>
<li><a href="#_testing_loop">1.4. Testing Loop</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_train_model"><a class="anchor" href="#_train_model"></a>1. Train Model</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>模型使用随机参数(random parameter)计算进行预测，<br>
即猜测(随机)basically guessing (randomly)；</p>
</li>
<li>
<p>为解决此问题，可更新内部参数(internal parameter)，<br>
也将参数称为模式pattern，使用nn.Parameter()和torch.randn()<br>
随机设置的权重weight和偏差值(bias value)，使其更好的表示数据；</p>
</li>
<li>
<p>可对此硬编码(因我们知道默认值，weight=0.7和bias=0.3)，<br>
很多时候不知道模型的理想参数是多少，相反，编写代码找出最佳值很有趣；</p>
</li>
<li>
<p>在PyTorch中创建损失函数loss function和优化器optimizer，<br>
为使模型自行更新其参数，需在recipe中添加更多内容；</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_loss_function_optimizer"><a class="anchor" href="#_loss_function_optimizer"></a>1.1. Loss Function Optimizer</h3>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Do What</th>
<th class="tableblock halign-left valign-top">Where Live</th>
<th class="tableblock halign-left valign-top">Common Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loss Function</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>测量measure模型预测(如y_pred)与真实标签(truth label如y_test)<br>
相比的错误程度(how wrong)，错误程度越低越好</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PyTorch在torch.nn中有很多(plenty of)内置的损失函数</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>回归问题的MAE：torch.nn.L1Loss()，</p>
</li>
<li>
<p>二分类问题的binary cross entropy：torch.nn.BCELoss()</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optimizer</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>告诉模型如何更新其内部参数以最好的降低损失，tell model how to<br>
update its internal parameters to best lower loss</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在torch.optim中查找各种优化函数的实现</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>SGD随机梯度下降：torch.optim.SGD()</p>
</li>
<li>
<p>Adam优化器optimizer：torch.optim.Adam()</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>SGD：stochastic gradient descent，随机梯度下降；</p>
</li>
<li>
<p>MAE：mean absolute error，平均绝对误差；</p>
</li>
<li>
<p>创建损失函数和优化器，以帮助改进模型，正处理的问题类型将决定要使用的损失函数和优化器；</p>
</li>
<li>
<p>但有些常用值，如SGD随机梯度下降或Adam优化器，被公认为效果很好；<br>
及用于回归问题(预测数字)的MAE(平均绝对误差)损失函数；<br>
或用于分类问题的binary cross entropy损失函数；</p>
</li>
<li>
<p>对我们的问题，因正在预测数字，<br>
可选择Pytorch中使用MAE(torch.nn.L1Loss())作为损失函数；</p>
</li>
<li>
<p>SGD：torch.optim.SGD(param,lr)：</p>
</li>
<li>
<p>param：想要优化的目标模型参数，如我们之前随机设置的权重weight和偏差值bias value；</p>
</li>
<li>
<p>lr：希望优化器更新参数的学习率，越高则优化器将尝试更大的更新(更新太大，优化器可能无法工作)，<br>
越低则优化器将尝试较小的更新(更新太小，优化器将花费太长时间才能找到理想值)</p>
</li>
<li>
<p>学习率learning rate被视为超参数hyperparameter，因它由ML工程师设置，<br>
学习率的常见起始值为0.01，0.001，0.0001，但这些值也可随时间的推移而调整，<br>
这称为学习率调度learning rate scheduling；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># create loss function,MAE loss is same as L1Loss
loss_fn = nn.L1Loss()

# create optimizer
# parameter of target model to optimize

# learning rate:how much optimizer should change parameter at each step,
# higher=more (less stable),lower=less (might take long time))
optimizer = torch.optim.SGD(params=model_0.parameters(),lr=0.01)</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/MaeLoss.png" alt="MaeLoss">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optimization_loop"><a class="anchor" href="#_optimization_loop"></a>1.2. Optimization Loop</h3>
<div class="paragraph">
<p>​​* 训练循环training loop涉及模型遍历训练数据并学习特征和标签之间的关系；</p>
</div>
<div class="ulist">
<ul>
<li>
<p>测试循环testing loop涉及遍历测试数据并评估模型在训练数据上<br>
学习的模式有多好(模型在训练期间永远不会看到测试数据)；</p>
</li>
<li>
<p>循环loop：希望模型查看(循环遍历loop through)每个数据集中的每个样本；</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_training_loop"><a class="anchor" href="#_training_loop"></a>1.3. Training Loop</h3>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number</th>
<th class="tableblock halign-left valign-top">Step Name</th>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Do What</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward Pass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">model(x_train)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该模型会遍历所有训练数据一次，并执行其forward()函数计算</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate Loss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">loss=loss_fn(y_pred,y_train)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将模型的输出(预测)与ground truth比较，并评估以查看其错误程度</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero Gradient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optimizer.zero_grad()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">优化器的梯度gradient设置为零(默认是累积的<br>
 accumulate)，故可针对特定的训练步骤重新计算它们</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform Backpropagation on Loss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">loss.backward()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">计算每个要更新的模型参数(每个参数的require_grad=True)的<br>
 损失梯度backpropagation，称为反向传播，故为向后backward</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update optimizer(gradient descent)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optimizer.step()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用require_grad=True来根据损失梯度更新参数，以改进它们</p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/PytorchTrainingLoop.png" alt="PytorchTrainingLoop">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>注：以上图片步骤排序或描述方式只是示例，经验法则：</p>
</li>
<li>
<p>在执行反向传播( <mark>loss.backward()</mark> )之前计算损失( <mark>loss = &#8230;&#8203;</mark> )；</p>
</li>
<li>
<p>在stepping them( <mark>optimizer.step()</mark> )<br>
之前将梯度gradient归零( <mark>optimizer.zero_grad()</mark> )；</p>
</li>
<li>
<p>在执行损失反向传播( <mark>loss.backward()</mark> )之后step优化器( <mark>optimizer.step()</mark> )；</p>
</li>
<li>
<p>step optimizer( <mark>optimizer.step()</mark> ) after performing<br>
backpropagation on loss( <mark>loss.backward()</mark> )；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_testing_loop"><a class="anchor" href="#_testing_loop"></a>1.4. Testing Loop</h3>
<table class="tableblock frame-all grid-all stripes-even fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number</th>
<th class="tableblock halign-left valign-top">Step Name</th>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Do What</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward Pass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">model(x_test)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该模型遍历所有训练数据一次，执行其forward()函数计算</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate Loss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">loss=loss_fn(y_pred,y_test)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将模型的输出(预测)与ground truth比较并评估，以了解它们的错误程度</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calulate Evaluation Metric(optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom Function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">除alongisde损失值，可能还需计算其他评估指标，如测试集的准确性accuracy</p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/PytorchTestingLoop.png" alt="PytorchTestingLoop">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>注：测试循环不包括执行反向传播backpropagation( <mark>loss.backward()</mark> )<br>
和stepping optimizer( <mark>optimizer.step()</mark> )；</p>
</li>
<li>
<p>因在测试过程中没有更改模型中的任何参数，它们已经被计算过，<br>
对测试，只对通过模型的正向传递(forward pass)的输出感兴趣；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>我们把以上所有问题放一起，训练模型100个epoch(通过数据向前，<br>
forward pass through data)，将每10个epoch对其评估；</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">torch.manual_seed(42)

# set epoch number(how many times model will pass over training data)
# 设置时期的数量(模型将通过训练数据的次数)
epoch = 100

# create empty loss list to track value
train_loss_value = []
test_loss_value = []
epoch_count = []

for e in range(epoch):
    ### Training
    # put model in training mode (model default state)
    model_0.train()

    # 1：Forward Pass on train data via forward() method inside
    y_pred = model_0(X_train)
    # print(y_pred)

    # 2：Calculate Loss (how different model prediction to ground truth)
    loss = loss_fn(y_pred,y_train)

    # 3：Zero Grad of optimizer
    optimizer.zero_grad()

    # 4：Loss Backward
    loss.backward()

    # 5：Progress optimizer
    optimizer.step()

    ### Testing
    # put model in evaluation mode
    model_0.eval()

    with torch.inference_mode():
      # 1：Forward Pass on test data
      test_pred = model_0(X_test)

      # 2：Caculate Loss on test data,prediction come in torch.float datatype,
      # so comparison need to be done with tensor of the same type
      test_loss = loss_fn(test_pred, y_test.type(torch.float))

      # Print Out What Happening
      if e % 10 == 0:
            epoch_count.append(e)
            train_loss_value.append(loss.detach().numpy())
            test_loss_value.append(test_loss.detach().numpy())
            print(f"Epoch: {e} | MAE Train Loss: {loss} | MAE Test Loss: {test_loss} ")

# Plot Loss Curve
plt.plot(epoch_count, train_loss_value, label="Train Loss")
plt.plot(epoch_count, test_loss_value, label="Test Loss")
plt.title("Training and Testing Loss Curve")
plt.ylabel("Loss")
plt.xlabel("Epoch")
plt.legend();

plt.savefig("TrainingTestingLossCurve.svg")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">Epoch: 0 | MAE Train Loss: 0.31288138031959534 | MAE Test Loss: 0.48106518387794495
Epoch: 10 | MAE Train Loss: 0.1976713240146637 | MAE Test Loss: 0.3463551998138428
Epoch: 20 | MAE Train Loss: 0.08908725529909134 | MAE Test Loss: 0.21729660034179688
Epoch: 30 | MAE Train Loss: 0.053148526698350906 | MAE Test Loss: 0.14464017748832703
Epoch: 40 | MAE Train Loss: 0.04543796554207802 | MAE Test Loss: 0.11360953003168106
Epoch: 50 | MAE Train Loss: 0.04167863354086876 | MAE Test Loss: 0.09919948130846024
Epoch: 60 | MAE Train Loss: 0.03818932920694351 | MAE Test Loss: 0.08886633068323135
Epoch: 70 | MAE Train Loss: 0.03476089984178543 | MAE Test Loss: 0.0805937647819519
Epoch: 80 | MAE Train Loss: 0.03132382780313492 | MAE Test Loss: 0.07232122868299484
Epoch: 90 | MAE Train Loss: 0.02788739837706089 | MAE Test Loss: 0.06473556160926819</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/Workflow/TrainingTestingLossCurve.svg" alt="TrainingTestingLossCurve">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><mark>注：忌重复执行，要重复执行，可从头开始执行，否则损失曲线是横的</mark></p>
</li>
<li>
<p>损失曲线显示损失随时间的推移而下降，损失是衡量模型错误程度的标准，越低越好；</p>
</li>
<li>
<p>损失会减少，因损失函数和优化器，模型的内部参数(权重和偏差)<br>
得到更新，以更好的反映数据中的潜在模式；</p>
</li>
<li>
<p>model internal parameter (weight and bias)<br>
update to better reflect underlying pattern in data</p>
</li>
<li>
<p>检视inspect模型的state_dict()，看看模型与我们为权重和偏差设置的原始值有多接近；</p>
</li>
<li>
<p>inspect model state_dict() to see how close model<br>
get to original value we set for weight and bias；</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># find model learned parameter
print("model learned following value for weight and bias：")
print(model_0.state_dict())
print("\noriginal value for weight and bias：")
print(f"weight: {weight}, bias: {bias}")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">model learned following value for weight and bias：
OrderedDict({'weight': tensor([0.5784]), 'bias': tensor([0.3513])})

original value for weight and bias：
weight: 0.7, bias: 0.3</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>模型非常接近于计算权重和偏差的确切原始值，若训练更长时间，可能会变得更接近；</p>
</li>
<li>
<p>尝试将上面的epoch修改为200，模型的损失曲线，权重和偏差值会发生啥？</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
	</div>
</main>
</div>
		<footer class="footer">
	
	
	
	<div class="footer-thanks">
		Authored in AsciiDoc
		<br /><br />
		Produced by Antora and Asciidoctor
  	</div>
  
	<div class="footer-legal" style="text-align:center">
		Gitee：<a href="https://gitee.com/iRecursion" 
			target="_blank">https://gitee.com/iRecursion</a>
		
		<br /><br />
		
		Github：<a href="https://github.com/iRecursion" 
			target="_blank">https://github.com/iRecursion</a>
	</div>
  
	<div class="footer-thanks" style="text-align:left">
		Copyright © 2024 Elf
		<br /><br />
		<address>
			Mailto：<a href="mailto:2032047511@qq.com">2032047511@qq.com</a>
		</address>
	</div>
	
</footer><script id="site-script" src="../../../../_/js/site.js" 
	data-ui-root-path="../../../../_"></script>

<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>


<script async src="../../../../_/js/vendor/prism-1.29.0-coy.js"></script>
  	</body>
</html>
